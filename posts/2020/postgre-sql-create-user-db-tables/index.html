<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>PostgreSQL: Create Users, Databases and Tables - Sir</title><meta name="Description" content=""><meta property="og:title" content="PostgreSQL: Create Users, Databases and Tables" />
<meta property="og:description" content="In the last post, we set up our PostgreSQL server. Now, we&rsquo;re going to create users, databases and tables.
PostgreSQL Schema Basics What is the definition of Schema in PostgreSQL Before we begin to create and set up the objects in PostgreSQL, we might need to understand the basic concept of schema in PostgreSQL. This article detailed describe the definition of Schema in PostgreSQL.
In a broader view of RDBMS, Schema is generally refered as the definition of tables, columns and other objects that constitute the database." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.leewei.co/posts/2020/postgre-sql-create-user-db-tables/" />
<meta property="article:published_time" content="2020-05-31T23:58:56+08:00" />
<meta property="article:modified_time" content="2020-05-31T23:58:56+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PostgreSQL: Create Users, Databases and Tables"/>
<meta name="twitter:description" content="In the last post, we set up our PostgreSQL server. Now, we&rsquo;re going to create users, databases and tables.
PostgreSQL Schema Basics What is the definition of Schema in PostgreSQL Before we begin to create and set up the objects in PostgreSQL, we might need to understand the basic concept of schema in PostgreSQL. This article detailed describe the definition of Schema in PostgreSQL.
In a broader view of RDBMS, Schema is generally refered as the definition of tables, columns and other objects that constitute the database."/>
<meta name="application-name" content="Sir">
<meta name="apple-mobile-web-app-title" content="Sir"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.leewei.co/posts/2020/postgre-sql-create-user-db-tables/" /><link rel="prev" href="https://www.leewei.co/posts/cmu-15-445/buffer-pool/" /><link rel="next" href="https://www.leewei.co/posts/cmu-15-445/hash-tables/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "PostgreSQL: Create Users, Databases and Tables",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.leewei.co\/posts\/2020\/postgre-sql-create-user-db-tables\/"
        },"genre": "posts","keywords": "PostgreSQL","wordcount":  1160 ,
        "url": "https:\/\/www.leewei.co\/posts\/2020\/postgre-sql-create-user-db-tables\/","datePublished": "2020-05-31T23:58:56+08:00","dateModified": "2020-05-31T23:58:56+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Lee Wei"},"author": {
                "@type": "Person",
                "name": "Lee Wei"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Sir">Sir</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="/tags/"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Sir">Sir</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="/tags/" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">PostgreSQL: Create Users, Databases and Tables</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Lee Wei</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-05-31">2020-05-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1160 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#postgresql-schema-basics">PostgreSQL Schema Basics</a>
      <ul>
        <li><a href="#what-is-the-definition-of-schema-in-postgresql">What is the definition of Schema in PostgreSQL</a></li>
        <li><a href="#why-do-we-need-to-use-schema">Why do we need to use Schema?</a></li>
        <li><a href="#schema-search-path">Schema Search Path</a></li>
        <li><a href="#schema-privilages">Schema privilages</a></li>
      </ul>
    </li>
    <li><a href="#create-users--database">Create Users &amp; Database</a></li>
    <li><a href="#set-up-privileges-for-database">Set up privileges for database</a></li>
    <li><a href="#create-table-and-set-up-table-privilages">Create Table and set up Table privilages</a></li>
    <li><a href="#credits">Credits</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>In the last <a href="https://www.leewei.co/posts/2020/postgre-sql-set-up/" target="_blank" rel="noopener noreffer">post</a>, we set up our PostgreSQL server.
Now, we&rsquo;re going to create users, databases and tables.</p>
<h2 id="postgresql-schema-basics">PostgreSQL Schema Basics</h2>
<h3 id="what-is-the-definition-of-schema-in-postgresql">What is the definition of Schema in PostgreSQL</h3>
<p>Before we begin to create and set up the objects in PostgreSQL, we might need to understand the basic
concept of schema in PostgreSQL.
<a href="https://severalnines.com/blog/postgresql-schema-management-basics" target="_blank" rel="noopener noreffer">This article</a> detailed describe the definition of <a href="https://www.postgresql.org/docs/9.1/ddl-schemas.html" target="_blank" rel="noopener noreffer">Schema</a> in PostgreSQL.</p>
<p>In a broader view of RDBMS, <code>Schema</code> is generally refered as the definition of tables, columns and other objects that constitute the database.
However, <code>Schema</code> in PostgreSQL is not the same. Schema is like a name space in PostgreSQL in which contains tables, data types, functions, and operators.</p>
<pre><code>database: taipei schema: house01 table: lee
database: taipei schema: house02 table: lee
</code></pre><p>The same object name can be used in different schemas without conflict.
For instance, there are two schema called <code>house01</code> and <code>house02</code>, and both of them have a table called <code>lee</code>.
If a user has privileges to access to both schemas, then he can access to both tables.
The user can use <code>database.schema.table</code> or <code>schema.table</code> to define the table he wants to access.</p>
<h3 id="why-do-we-need-to-use-schema">Why do we need to use Schema?</h3>
<ol>
<li>To allow many users to use one database without interfering with each other.</li>
<li>To organize database objects into logical groups to make them more manageable.</li>
<li>Third-party applications can be put into separate schemas so they do not collide with the names of other objects.</li>
</ol>
<h3 id="schema-search-path">Schema Search Path</h3>
<p>By default, there is a schema created by PostgreSQL called <code>public</code>.</p>
<p>The best practice is not to write a particular schema name into the application, and use <code>Search Path</code> instead.
A Search Path is a list of schemas that lets the database system to look in.
The first matching table in the search path is taken. If there is no match in the search path, an error is reported, even if matching table names exist in other schemas in the database.</p>
<p>We can see from the below example, our current schema is <code>public</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="n">postgres</span><span class="o">=#</span> <span class="k">SHOW</span> <span class="n">search_path</span><span class="p">;</span>
   <span class="n">search_path</span>
<span class="c1">-----------------
</span><span class="c1"></span> <span class="s2">&#34;$user&#34;</span><span class="p">,</span> <span class="k">public</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</code></pre></div><p>Let&rsquo;s create a new schema <code>myschema</code> and re-organize the search path.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="n">postgres</span><span class="o">=#</span> <span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">myschema</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">SCHEMA</span>
<span class="n">postgres</span><span class="o">=#</span> <span class="k">SET</span> <span class="n">search_path</span> <span class="k">TO</span> <span class="n">myschema</span><span class="p">,</span><span class="k">public</span><span class="p">;</span>
<span class="k">SET</span>
<span class="n">postgres</span><span class="o">=#</span> <span class="k">SHOW</span> <span class="n">search_path</span><span class="p">;</span>
   <span class="n">search_path</span>
<span class="c1">------------------
</span><span class="c1"></span> <span class="n">myschema</span><span class="p">,</span> <span class="k">public</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</code></pre></div><p>After the configuration, newly created table will be located in <code>myschema</code>.
We will stick with schema <code>public</code> since this is just a demo project. ðŸ˜¬</p>
<h3 id="schema-privilages">Schema privilages</h3>
<p>By default, users cannot access any objects in schemas they do not own. To allow that, the owner of the schema must grant the <code>USAGE</code> privilege for the users. Every user has <code>CREATE</code> and <code>USAGE</code> privileges on the schema public by default. We can revoke the privilages using the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="cm">/* The first public is schema
</span><span class="cm">The second PUBLIC is every user */</span>
<span class="k">REVOKE</span> <span class="k">CREATE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">FROM</span> <span class="k">PUBLIC</span><span class="p">;</span>
</code></pre></div><p>Based on the official manual:</p>
<p><code>There is no concept of a public schema in the SQL standard. For maximum conformance to the standard, you should not use (perhaps even remove) the public schema.</code></p>
<p>It is still recommended to create new schema for production use projects.</p>
<h2 id="create-users--database">Create Users &amp; Database</h2>
<p>Both <code>CREATE USER</code> and <code>CREATE ROLE</code> are able to create users.
The only difference is that <code>CREATE USER</code> <code>LOGIN</code> parameter is assumed by default,
where as <code>CREATE ROLE</code> <code>NOLOGIN</code> is default.</p>
<p>According to the official document of PostgreSQL:</p>
<p>There is no concept of inheritance for the privileges of a <code>CREATEROLE</code>-role.<br>
<strong>That means that even if a role does not have a certain privilege but is allowed to create other roles,
it can easily create another role with different privileges than its own (except for creating roles with superuser privileges).</strong></p>
<p>We will strictly set parameters when creating users.
Create file <code>create_db.sql</code></p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">db_admin</span> <span class="n">LOGIN</span> <span class="n">PASSWORD</span> <span class="s1">&#39;123456&#39;</span> <span class="n">NOSUPERUSER</span> <span class="n">INHERIT</span> <span class="k">NOCREATEDB</span> <span class="n">NOCREATEROLE</span> <span class="n">NOREPLICATION</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">db_user</span> <span class="n">LOGIN</span> <span class="n">PASSWORD</span> <span class="s1">&#39;123456&#39;</span> <span class="n">NOSUPERUSER</span> <span class="n">INHERIT</span> <span class="k">NOCREATEDB</span> <span class="n">NOCREATEROLE</span> <span class="n">NOREPLICATION</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">db_readonly</span> <span class="n">LOGIN</span> <span class="n">PASSWORD</span> <span class="s1">&#39;123456&#39;</span> <span class="n">NOSUPERUSER</span> <span class="n">INHERIT</span> <span class="k">NOCREATEDB</span> <span class="n">NOCREATEROLE</span> <span class="n">NOREPLICATION</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">db</span> <span class="k">with</span> <span class="k">ENCODING</span> <span class="o">=</span> <span class="s1">&#39;UTF8&#39;</span> <span class="n">LC_COLLATE</span> <span class="o">=</span> <span class="s1">&#39;en_US.UTF-8&#39;</span> <span class="n">LC_CTYPE</span> <span class="o">=</span> <span class="s1">&#39;en_US.UTF-8&#39;</span> <span class="k">CONNECTION</span> <span class="k">LIMIT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">template</span><span class="o">=</span><span class="n">template0</span><span class="p">;</span>

<span class="k">ALTER</span> <span class="k">DATABASE</span> <span class="n">db</span> <span class="k">OWNER</span> <span class="k">TO</span> <span class="n">db_admin</span><span class="p">;</span>
</code></pre></div><p>Run the following command</p>
<div class="highlight"><pre class="chroma"><code class="language-Shell" data-lang="Shell">$ psql -h localhost -U <span class="o">[</span>username<span class="o">]</span> -f create_db.sql
</code></pre></div><p>Check if the users are created</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="n">postgres</span><span class="o">=#</span> <span class="err">\</span><span class="n">du</span>
                                    <span class="n">List</span> <span class="k">of</span> <span class="n">roles</span>
  <span class="k">Role</span> <span class="n">name</span>  <span class="o">|</span>                         <span class="n">Attributes</span>                         <span class="o">|</span> <span class="n">Member</span> <span class="k">of</span>
<span class="c1">-------------+------------------------------------------------------------+-----------
</span><span class="c1"></span> <span class="n">db_admin</span>    <span class="o">|</span>                                                            <span class="o">|</span> <span class="err">{}</span>
 <span class="n">db_readonly</span> <span class="o">|</span>                                                            <span class="o">|</span> <span class="err">{}</span>
 <span class="n">db_user</span>     <span class="o">|</span>                                                            <span class="o">|</span> <span class="err">{}</span>
 <span class="n">postgres</span>    <span class="o">|</span> <span class="n">Superuser</span><span class="p">,</span> <span class="k">Create</span> <span class="k">role</span><span class="p">,</span> <span class="k">Create</span> <span class="n">DB</span><span class="p">,</span> <span class="n">Replication</span><span class="p">,</span> <span class="n">Bypass</span> <span class="n">RLS</span> <span class="o">|</span> <span class="err">{}</span>
</code></pre></div><p>Check if the database is created</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="n">postgres</span><span class="o">=#</span> <span class="err">\</span><span class="n">l</span>
                                  <span class="n">List</span> <span class="k">of</span> <span class="n">databases</span>
   <span class="n">Name</span>    <span class="o">|</span>  <span class="k">Owner</span>   <span class="o">|</span> <span class="k">Encoding</span> <span class="o">|</span>   <span class="k">Collate</span>   <span class="o">|</span>    <span class="n">Ctype</span>    <span class="o">|</span>   <span class="k">Access</span> <span class="k">privileges</span>
<span class="c1">-----------+----------+----------+-------------+-------------+-----------------------
</span><span class="c1"></span> <span class="n">db</span>        <span class="o">|</span> <span class="n">db_admin</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="n">en_US</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span> <span class="o">|</span> <span class="n">en_US</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span> <span class="o">|</span>
 <span class="n">postgres</span>  <span class="o">|</span> <span class="n">postgres</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="k">C</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>     <span class="o">|</span> <span class="k">C</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>     <span class="o">|</span>
 <span class="n">template0</span> <span class="o">|</span> <span class="n">postgres</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="k">C</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>     <span class="o">|</span> <span class="k">C</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>     <span class="o">|</span> <span class="o">=</span><span class="k">c</span><span class="o">/</span><span class="n">postgres</span>          <span class="o">+</span>
           <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span> <span class="n">postgres</span><span class="o">=</span><span class="n">CTc</span><span class="o">/</span><span class="n">postgres</span>
 <span class="n">template1</span> <span class="o">|</span> <span class="n">postgres</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="k">C</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>     <span class="o">|</span> <span class="k">C</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>     <span class="o">|</span> <span class="o">=</span><span class="k">c</span><span class="o">/</span><span class="n">postgres</span>          <span class="o">+</span>
           <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>             <span class="o">|</span>             <span class="o">|</span> <span class="n">postgres</span><span class="o">=</span><span class="n">CTc</span><span class="o">/</span><span class="n">postgres</span>
</code></pre></div><h2 id="set-up-privileges-for-database">Set up privileges for database</h2>
<p>If we didn&rsquo;t set the timezone of the database, Postgre will try to use operating system&rsquo;s default timezone.
Run the following SQL statement to configure our database&rsquo;s timezone, just in case.</p>
<p>Create file <code>setup_db.sql</code> and execute the following</p>
<div class="highlight"><pre class="chroma"><code class="language-Shell" data-lang="Shell">$ psql -h localhost -U <span class="o">[</span>username<span class="o">]</span> -f setup_db.sql
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">ALTER</span> <span class="k">DATABASE</span> <span class="n">db</span> <span class="k">SET</span> <span class="n">timezone</span> <span class="k">TO</span> <span class="s1">&#39;UTC&#39;</span><span class="p">;</span>

<span class="cm">/* 
</span><span class="cm">Revoke access and create for everyone on schema `public`.
</span><span class="cm">Grant `USAGE` and `CREATE` for admin user `db_admin`.
</span><span class="cm">Grant `USAGE` for `db_user` and `db_readonly`.
</span><span class="cm">*/</span>
<span class="k">REVOKE</span> <span class="k">USAGE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">FROM</span> <span class="k">PUBLIC</span><span class="p">;</span>
<span class="k">REVOKE</span> <span class="k">CREATE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">FROM</span> <span class="k">PUBLIC</span><span class="p">;</span>

<span class="k">GRANT</span> <span class="k">USAGE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">to</span> <span class="n">db_admin</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">CREATE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">to</span> <span class="n">db_admin</span><span class="p">;</span>

<span class="k">GRANT</span> <span class="k">USAGE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">to</span> <span class="n">db_user</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">USAGE</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">to</span> <span class="n">db_readonly</span><span class="p">;</span>
</code></pre></div><p>Check the timezone</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="n">postgres</span><span class="o">=#</span> <span class="k">show</span> <span class="n">timezone</span><span class="p">;</span>
 <span class="n">TimeZone</span>
<span class="c1">----------
</span><span class="c1"></span> <span class="n">Etc</span><span class="o">/</span><span class="n">UTC</span>
</code></pre></div><h2 id="create-table-and-set-up-table-privilages">Create Table and set up Table privilages</h2>
<p>Create file <code>create_table.sql</code> and execute the following</p>
<div class="highlight"><pre class="chroma"><code class="language-Shell" data-lang="Shell">$ psql -h localhost -U <span class="o">[</span>username<span class="o">]</span> -f create_table.sql
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">product</span><span class="p">(</span>
	<span class="n">id</span> <span class="n">uuid</span><span class="p">,</span>
	<span class="n">name</span> <span class="nb">character</span> <span class="nb">varying</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
	<span class="k">type</span> <span class="nb">character</span> <span class="nb">varying</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>

	<span class="n">create_time</span> <span class="k">timestamp</span> <span class="k">with</span> <span class="n">time</span> <span class="k">zone</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span> <span class="k">current_timestamp</span><span class="p">,</span>
	<span class="n">update_time</span> <span class="k">timestamp</span> <span class="k">with</span> <span class="n">time</span> <span class="k">zone</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span> <span class="k">current_timestamp</span><span class="p">,</span>
	<span class="k">CONSTRAINT</span> <span class="s2">&#34;p_pk&#34;</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div><p>Check if table is created as expected.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="n">postgres</span><span class="o">=#</span> <span class="err">\</span><span class="n">d</span>
          <span class="n">List</span> <span class="k">of</span> <span class="n">relations</span>
 <span class="k">Schema</span> <span class="o">|</span>  <span class="n">Name</span>   <span class="o">|</span> <span class="k">Type</span>  <span class="o">|</span>  <span class="k">Owner</span>
<span class="c1">--------+---------+-------+----------
</span><span class="c1"></span> <span class="k">public</span> <span class="o">|</span> <span class="n">product</span> <span class="o">|</span> <span class="k">table</span> <span class="o">|</span> <span class="n">postgres</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</code></pre></div><p>Grant privileges for users.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">GRANT</span> <span class="k">SELECT</span><span class="p">,</span> <span class="k">INSERT</span><span class="p">,</span> <span class="k">UPDATE</span><span class="p">,</span> <span class="k">DELETE</span><span class="p">,</span> <span class="k">REFERENCES</span> <span class="k">ON</span> <span class="k">TABLE</span> <span class="n">product</span> <span class="k">to</span> <span class="n">db_user</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="k">TABLE</span> <span class="n">product</span> <span class="k">to</span> <span class="n">db_readonly</span><span class="p">;</span>
</code></pre></div><p>Check users&rsquo; privileges</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="n">postgres</span><span class="o">=#</span> <span class="k">SELECT</span> <span class="n">table_catalog</span><span class="p">,</span> <span class="n">table_schema</span><span class="p">,</span> <span class="k">table_name</span><span class="p">,</span> <span class="n">privilege_type</span>
<span class="k">FROM</span>   <span class="n">information_schema</span><span class="p">.</span><span class="n">table_privileges</span>
<span class="k">WHERE</span>  <span class="n">grantee</span> <span class="o">=</span> <span class="s1">&#39;db_user&#39;</span><span class="p">;</span>
 <span class="n">table_catalog</span> <span class="o">|</span> <span class="n">table_schema</span> <span class="o">|</span> <span class="k">table_name</span> <span class="o">|</span> <span class="n">privilege_type</span>
<span class="c1">---------------+--------------+------------+----------------
</span><span class="c1"></span> <span class="n">postgres</span>      <span class="o">|</span> <span class="k">public</span>       <span class="o">|</span> <span class="n">product</span>    <span class="o">|</span> <span class="k">INSERT</span>
 <span class="n">postgres</span>      <span class="o">|</span> <span class="k">public</span>       <span class="o">|</span> <span class="n">product</span>    <span class="o">|</span> <span class="k">SELECT</span>
 <span class="n">postgres</span>      <span class="o">|</span> <span class="k">public</span>       <span class="o">|</span> <span class="n">product</span>    <span class="o">|</span> <span class="k">UPDATE</span>
 <span class="n">postgres</span>      <span class="o">|</span> <span class="k">public</span>       <span class="o">|</span> <span class="n">product</span>    <span class="o">|</span> <span class="k">DELETE</span>
 <span class="n">postgres</span>      <span class="o">|</span> <span class="k">public</span>       <span class="o">|</span> <span class="n">product</span>    <span class="o">|</span> <span class="k">REFERENCES</span>
<span class="p">(</span><span class="mi">5</span> <span class="k">rows</span><span class="p">)</span>

<span class="n">postgres</span><span class="o">=#</span> <span class="k">SELECT</span> <span class="n">table_catalog</span><span class="p">,</span> <span class="n">table_schema</span><span class="p">,</span> <span class="k">table_name</span><span class="p">,</span> <span class="n">privilege_type</span>
<span class="k">FROM</span>   <span class="n">information_schema</span><span class="p">.</span><span class="n">table_privileges</span>
<span class="k">WHERE</span>  <span class="n">grantee</span> <span class="o">=</span> <span class="s1">&#39;db_readonly&#39;</span><span class="p">;</span>
 <span class="n">table_catalog</span> <span class="o">|</span> <span class="n">table_schema</span> <span class="o">|</span> <span class="k">table_name</span> <span class="o">|</span> <span class="n">privilege_type</span>
<span class="c1">---------------+--------------+------------+----------------
</span><span class="c1"></span> <span class="n">postgres</span>      <span class="o">|</span> <span class="k">public</span>       <span class="o">|</span> <span class="n">product</span>    <span class="o">|</span> <span class="k">SELECT</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</code></pre></div><h2 id="credits">Credits</h2>
<ul>
<li>Special Thanks for <a href="https://github.com/TritonHo/demo" target="_blank" rel="noopener noreffer">Triton Ho&rsquo;s demo repo</a></li>
<li><a href="https://www.postgresql.org/docs/9.1/index.html" target="_blank" rel="noopener noreffer">PostgreSQL Official Documentation</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-05-31</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/postgresql/">PostgreSQL</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/cmu-15-445/buffer-pool/" class="prev" rel="prev" title="CMU Databases Systems: 05 Buffer Pool &amp; Memory Management"><i class="fas fa-angle-left fa-fw"></i>CMU Databases Systems: 05 Buffer Pool &amp; Memory Management</a>
            <a href="/posts/cmu-15-445/hash-tables/" class="next" rel="next" title="CMU Databases Systems: 06 Hash Tables">CMU Databases Systems: 06 Hash Tables<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.74.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Lee Wei</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://https-www-leewei-co.disqus.com/embed.js" defer></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
